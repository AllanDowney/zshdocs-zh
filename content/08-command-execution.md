# 第八章：命令执行

如果命令名称不包含斜杠，则 Shell 会尝试查找它。如果存在具有该名称的 Shell 函数，则函数按照 [Functions](09-functions.md) 中所述调用。如果存在一个 Shell 内置的 (builtin) 函数，则调用内置函数。

否则，Shell 会在 `$path` 的每个元素中搜索包含该名称的可执行文件的目录。

如果执行失败：将打印一条错误消息，并且返回以下值。

`127`
: 搜索未成功。错误消息为 _'找不到命令： (command not found: )'.cmd_

`126`
: 可执行文件权限不足，是目录或特殊文件，或者不是脚本且格式无法被操作系统识别。确切的情况和错误消息取决于操作系统；参见 `execve（2）`。

如果执行失败是因为文件不是可执行格式，并且文件不是目录，则假定它是一个 Shell 脚本。调用 `/bin/sh` 来执行它。如果程序是以 `#!` 开始的文件，第一行的其余部分指定了程序的解释器。Shell 将在内核中不处理此可执行格式的操作系统上执行指定的解释器。

如果没有找到外部命令，但存在函数 `command_not_found_handler` ，则 Shell 将使用所有命令行参数执行此函数。函数的返回状态变为命令的状态。请注意，处理程序在 SubShell 中执行外部命令，因此对目录、Shell 参数等的更改对主 Shell 没有影响。
