<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content=夜坂雅><link href=https://shadowrz.github.io/zshdocs-zh/06-shell-grammer/ rel=canonical><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.2.2, mkdocs-material-7.3.1"><title>第六章：Shell 语法 - Zsh 中文手册</title><link rel=stylesheet href=../assets/stylesheets/main.1c75ef36.min.css><link rel=stylesheet href=../assets/stylesheets/palette.3f5d1f46.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=deep-orange data-md-color-accent=blue> <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#shell class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Zsh 中文手册" class="md-header__button md-logo" aria-label="Zsh 中文手册" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path fill-rule=evenodd d="M8.78 4.97a.75.75 0 0 1 0 1.06L2.81 12l5.97 5.97a.75.75 0 1 1-1.06 1.06l-6.5-6.5a.75.75 0 0 1 0-1.06l6.5-6.5a.75.75 0 0 1 1.06 0zm6.44 0a.75.75 0 0 0 0 1.06L21.19 12l-5.97 5.97a.75.75 0 1 0 1.06 1.06l6.5-6.5a.75.75 0 0 0 0-1.06l-6.5-6.5a.75.75 0 0 0-1.06 0z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Zsh 中文手册 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 第六章：Shell 语法 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-orange data-md-color-accent=blue aria-label type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-orange data-md-color-accent=blue aria-label type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/ShadowRZ/zshdocs-zh/ title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> ShadowRZ/zshdocs-zh </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Zsh 中文手册" class="md-nav__button md-logo" aria-label="Zsh 中文手册" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path fill-rule=evenodd d="M8.78 4.97a.75.75 0 0 1 0 1.06L2.81 12l5.97 5.97a.75.75 0 1 1-1.06 1.06l-6.5-6.5a.75.75 0 0 1 0-1.06l6.5-6.5a.75.75 0 0 1 1.06 0zm6.44 0a.75.75 0 0 0 0 1.06L21.19 12l-5.97 5.97a.75.75 0 1 0 1.06 1.06l6.5-6.5a.75.75 0 0 0 0-1.06l-6.5-6.5a.75.75 0 0 0-1.06 0z"/></svg> </a> Zsh 中文手册 </label> <div class=md-nav__source> <a href=https://github.com/ShadowRZ/zshdocs-zh/ title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </div> <div class=md-source__repository> ShadowRZ/zshdocs-zh </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../00-translator-notes/ class=md-nav__link> 译者注释 </a> </li> <li class=md-nav__item> <a href=../01-manual-description/ class=md-nav__link> 第一章：Zsh 手册 </a> </li> <li class=md-nav__item> <a href=../02-introduction/ class=md-nav__link> 第二章：简介 </a> </li> <li class=md-nav__item> <a href=../03-roadmap/ class=md-nav__link> 第三章：路程图 </a> </li> <li class=md-nav__item> <a href=../04-invocation/ class=md-nav__link> 第四章：启动 </a> </li> <li class=md-nav__item> <a href=../05-files/ class=md-nav__link> 第五章：文件 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 第六章：Shell 语法 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 第六章：Shell 语法 </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 简单的命令与管道 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 前置命令修饰符 </a> </li> <li class=md-nav__item> <a href=#complex-commands class=md-nav__link> Complex Commands 复杂命令 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 复杂命令的替代形式 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 保留字 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../07-redirection/ class=md-nav__link> 第七章：重定向 </a> </li> <li class=md-nav__item> <a href=../08-command-execution/ class=md-nav__link> 第八章：运行命令 </a> </li> <li class=md-nav__item> <a href=../09-functions/ class=md-nav__link> 第九章：函数 </a> </li> <li class=md-nav__item> <a href=../10-jobs-and-signals/ class=md-nav__link> 第十章：任务控制与信号量 </a> </li> <li class=md-nav__item> <a href=../11-atithmetics/ class=md-nav__link> 第十一章：算术扩展 </a> </li> <li class=md-nav__item> <a href=../12-conditionals/ class=md-nav__link> 第十二章：条件表达式 </a> </li> <li class=md-nav__item> <a href=../13-prompt-expns/ class=md-nav__link> 第十三章：提示符展开 </a> </li> <li class=md-nav__item> <a href=../14-expansions/ class=md-nav__link> 第十四章：展开 </a> </li> <li class=md-nav__item> <a href=../15-parameters/ class=md-nav__link> 第十五章：参数 </a> </li> <li class=md-nav__item> <a href=../16-options/ class=md-nav__link> 第十六章：选项 </a> </li> <li class=md-nav__item> <a href=../17-builtins/ class=md-nav__link> 第十七章：Shell 内建命令 </a> </li> <li class=md-nav__item> <a href=../18-zle-line-editor/ class=md-nav__link> 第十八章：ZLE 行编辑器 </a> </li> <li class=md-nav__item> <a href=../19-completion-widgets/ class=md-nav__link> 第十九章：补全部件 </a> </li> <li class=md-nav__item> <a href=../20-completion-system/ class=md-nav__link> 第二十章：补全系统 </a> </li> <li class=md-nav__item> <a href=../21-compctl-completions/ class=md-nav__link> 第二十一章：基于 `compctl` 的补全系统 </a> </li> <li class=md-nav__item> <a href=../22-zsh-modules/ class=md-nav__link> 第二十二章：Zsh 模块 </a> </li> <li class=md-nav__item> <a href=../23-zcal-calendar/ class=md-nav__link> 第二十三章：日历函数系统 </a> </li> <li class=md-nav__item> <a href=../24-ztcp-tcpsocket/ class=md-nav__link> 第二十四章：TCP 函数系统 </a> </li> <li class=md-nav__item> <a href=../25-zftp-ftpclient/ class=md-nav__link> 第二十五章：Zftp 函数系统 </a> </li> <li class=md-nav__item> <a href=../26-user-contrib/ class=md-nav__link> 第二十六章：用户贡献 </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 简单的命令与管道 </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 前置命令修饰符 </a> </li> <li class=md-nav__item> <a href=#complex-commands class=md-nav__link> Complex Commands 复杂命令 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 复杂命令的替代形式 </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 保留字 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/ShadowRZ/zshdocs-zh/edit/master/docs/06-shell-grammer.md title=编辑此页 class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=shell>第六章：Shell 语法<a class=headerlink href=#shell title="Permanent link">&para;</a></h1> <h2 id=_1>简单的命令与管道<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>一个简单的命令是一个由空格分开的单词组成的可选的参数赋值序列，且在其中可以使用重定向。有关参数位置的描述，请参见 %% 一节的开头。</p> <p>第一个单词是要执行的命令，其余的单词（如果有）则是该命令的参数。如果给出了命令名称，则在执行命令时，对参数的赋值会改变命令的环境。一个简单命令的值是其返回值，若命令被信号终止，则是128 加上信号编号。例如： <div class=highlight><pre><span></span><code><span class=nb>echo</span> foo
</code></pre></div> 是一个带有参数的简单命令。</p> <p>管道既可以是简单命令，也可以是两个或多个简单命令的序列，其中每个命令之间用 <code>|</code> 或 <code>|＆</code> 分隔。如果命令之间用 <code>|</code> 分隔，则第一个命令的标准输出将连接到下一个命令的标准输入。 <code>|＆</code> 是 <code>2&gt;＆1 |</code> 的简写，它将命令的标准输出和标准错误连接到下一个的标准输入。除非管道前面加有 <code>!</code>，管道的值就是最后一条命令的返回值。如果有 <code>!</code>，管道的值就是是最后一条命令的返回值的逻辑反。例如， <div class=highlight><pre><span></span><code><span class=nb>echo</span> foo <span class=p>|</span> sed <span class=s1>&#39;s/foo/bar/&#39;</span>
</code></pre></div> 是管道，第一个命令的输出（<code>foo</code> 加一个换行符）将传递给第二个命令的输入。</p> <p>如果管道前面带有 <code>coproc</code>，则将其作为协进程（coprocess）执行并在它和父 shell 之间建立了一条双向管道。父 shell 可以通过 <code>&gt;＆p</code> 和 <code>&lt;＆p</code> 重定向操作符或通过 <code>print -p</code> 和 <code>read -p</code> 来读取或写入协进程。管道之前不能同时带有 <code>coproc</code> 和 <code>!</code>。如果启用了作业管理，则可以将协进程视为输入和输出，而不是普通的后台作业。</p> <p>子列表可以是单个管道，也可以是由 <code>&amp;&amp;</code> 或 <code>||</code> 分隔的两个或多个管道的序列。如果两个管道用 <code>&amp;&amp;</code> 分隔，则仅当第一个管道成功（返回零状态）时才执行第二个管道。如果两个管道用 <code>||</code> 分隔，则仅当第一个失败（返回非零状态）时才执行第二个管道。两个运算符具有相同的优先级，并且是左结合的。子列表的值是最后执行的管道的值。例如， <div class=highlight><pre><span></span><code>dmesg <span class=p>|</span> grep panic <span class=o>&amp;&amp;</span> print yes
</code></pre></div> 是一个由两个管道组成的子列表，第二个管道只是一个简单命令，仅当 <code>grep</code> 命令返回零状态时才会执行。若返回值不为零，则子列表的返回值为第一个的返回值，否则则为 <code>print</code> 的返回值（几乎肯定为零）。</p> <p>列表是由以 <code>;</code>、<code>＆</code>、<code>＆|</code>、<code>＆!</code> 或换行符结尾的零个或多个子列表的序列。若列表作为出现在圆括号或花括号之间的复杂命令，最后一个子列表的终止符可以省略。当子列表以分号或换行符终止时，shell 将在执行下一个子列表之前等待其完成。如果子列表以 <code>＆</code>，<code>＆|</code> 或 <code>＆!</code> 终止，则 shell 将在后台执行它的最后一个管道，并且不等待其完成（请注意 zsh 与其他 shell 的区别在于 zsh 会在后台执行整个子列表）。在这种情况下，后台管道返回零状态。</p> <p>更一般地，列表可以看作是任何 shell 命令的集合，且包含以下复杂命令。请注意下文中出现“列表”一词时，都隐含这一种情况。例如，shell 函数中的命令形成了一种特殊的列表。</p> <h2 id=_2>前置命令修饰符<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>一个简单命令之前可能会带有前置命令修饰符，该修饰符将会更改命令的解释方式。这些修饰符是 shell 内置命令，但 <code>nocorrect</code> 除外，后者是保留字。</p> <dl> <dt><code>-</code></dt> <dd>该命令按照 <code>argv[0]</code> 字符串前面的追加一个 <code>-</code> 执行。</dd> <dt><code>builtin</code></dt> <dd>这个命令被视为内建命令执行，而不是通常的会考虑 shell 函数和外部命令。</dd> <dt><code>command [ -pvV ]</code></dt> <dd>这个命令被视为外部命令执行，而不会考虑 shell 函数或者内建命令。如果设置了 <code>POSIX_BUILTINS</code> 选项，内建命令也会被考虑执行，但是某些特性会被抑制。<code>-p</code> 选项可以指示默认的搜索路径，以取代 <code>$path</code> 数组。使用 <code>-v</code> 选项的话，<code>command</code> 的行为类似于 <code>whence</code>；使用 <code>-V</code> 选项，效果等同于 <code>whence -v</code>。</dd> <dt><code>exec [ -cl ] [ -a argv0 ]</code></dt> <dd>以下命令以及所有参数将代替当前进程运行，而不是作为子进程运行。shell 不 fork 而被更换。该 shell 不调用 <code>TRAPEXIT</code>，也不加载（<code>source</code>）<code>zlogout</code>。提供这些选项是为了与其他 shell 兼容。 <br> <span class="critic comment">译注：即和 POSIX syscall `exec()` 的表现相似。</span> <br> <code>-c</code> 选项会清理环境。 <br> <code>-l</code> 选项效果与 <code>-</code> 前置命令修饰符类似，将替代运行的命令作为登录 shell (login shell) 对待，并在其 <code>argv[0]</code> 前附加 <code>-</code>。该选项与 <code>-a</code> 选项一同使用无效。 <br> <code>-a</code> 选项用于显式指定替换命令要使用的 <code>argv[0]</code> 字符串（命令所看到的自身的名称），并且直接等效于设置 <code>ARGV0</code> 环境变量。</dd> <dt><code>nocorrect</code></dt> <dd>不会对任何单词进行拼写修正。它必须出现在任何其他前置命令修饰符之前，因为它会在任何解析之前立即被解释。在非交互式（non-interactive） shell 中无效。</dd> <dt><code>noglob</code></dt> <dd>不会对任何单词执行文件名生成（globbing）。</dd> </dl> <h2 id=complex-commands>Complex Commands 复杂命令<a class=headerlink href=#complex-commands title="Permanent link">&para;</a></h2> <p>zsh 中的复杂命令是以下之一：</p> <dl> <dt><code>if</code> list <code>then</code> list [ <code>elif</code> list <code>then</code> list ] ... [ <code>else</code> list ] <code>fi</code></dt> <dd>执行 <code>if</code> 后的列表，如果返回值为零，则执行 <code>then</code> 后的列表。否则，将执行 <code>elif</code> 后的列表，并且如果 <code>elif</code> 后的列表返回值为零，则执行 <code>then</code> 后的列表。如果每个 <code>elif</code> 后的列表都返回非零值，<code>else</code> 后的列表将被执行。</dd> <dt><code>for</code> name ... [ <code>in</code> word ... ] term <code>do</code> list <code>done</code></dt> <dd>展开单词列表，然后依次将每个单词设置参数 name ，每次执行列表。如果省略了 <code>in</code> word，请使用位置参数代替单词。 <br> term 包含一个或多个换行符或分号作为终止符，并且在省略 <code>in</code> word 时是可选的。 <br> 单词列表之前可以出现多个参数 name。如果给出了 N 个参数，则在每次执行循环时，会将下 N 个字分配给相应的参数。如果参数多于其余单词，则将其余参数分别设置为空字符串。当没有剩余的单词分配给名字时，循环的执行结束。<code>in</code> 只能作为参数列表中的第一个 name 出现，否则将被视为标记参数列表的结尾。</dd> <dt><code>for</code> <code>(( [expr1] ; [expr2] ; [expr3] ))</code> <code>do</code> list <code>done</code></dt> <dd>首先对算术表达式 expr1 求值（请参阅 %%）。反复对算术表达式 expr2 求值，直到其求值为零，并且当算术表达式 expr2 不为零时，执行 list 并求值算术表达式 expr3。如果省略任何表达式，则其行为就像它的值为 1。</dd> <dt><code>while</code> list <code>do</code> list <code>done</code></dt> <dd>只要 <code>while</code> 后的列表返回值为零，就一直执行 <code>do</code> 后的列表。</dd> <dt><code>until</code> list <code>do</code> list <code>done</code></dt> <dd>只要 <code>until</code> 后的列表返回值为非零，就一直执行 <code>do</code> 后的列表。</dd> <dt><code>repeat</code> word <code>do</code> list <code>done</code></dt> <dd>扩展 word 并将其视为算术表达式，该表达式的计算结果必须为数字 n。然后执行 n 次列表。 <br> 当 zsh 在模拟另一个 shell 的模式下启动时，默认情况下将禁用重复语法。可以使用命令 <code>enable -r repeat</code> 启用它。</dd> <dt><code>case</code> word <code>in</code> <code>[ [(]</code> pattern <code>[ |</code> pattern <code>] ... )</code> list <code>(;;|;&amp;|;|) ]</code> ... <code>esac</code></dt> <dd>执行与第一个与 word 匹配的 pattern 相关联的列表（如果有）。pattern 的形式与用于 glob 的形式相同。请参阅 %%。 <br> 还需要注意的是，尽管括号和竖线周围可能会出现空白，并且在这些点处将从图案中去除空白，除非设置了 <code>SH_GLOB</code> 选项，带有替代选项(<code>|</code>)的整个 pattern 被 shell 视为等同于括号内的一组 pattern。 <br> 空白可能会出现在图案的其他地方；这不会被去除。如果设置了 <code>SH_GLOB</code> 选项，则可以将开括号清楚地视为语法的一部分，该表达式将解析为单独的词，并将它们视为严格的替代词（与其他shell一样）。 如果执行的列表以 <code>;＆</code> 而不是 <code>;;</code> 终止，则还将执行下面的列表。除非到达esac，否则服从列表的终止符规则 <code>;;</code>、<code>;＆</code>或 <code>;|</code> 适用。 <br> 如果执行的列表以 <code>;|</code> 终止，shell 继续扫描 pattern 以寻找下一个匹配项，执行相应的列表，并将规则应用于相应的终止符 <code>;;</code>、<code>;＆</code> 或 <code>;|</code>。请注意，word 不会重新展开；所有适用的 pattern 均使用相同的 word 进行测试。</dd> <dt><code>select</code> name [ <code>in</code> word ... term ] <code>do</code> list <code>done</code></dt> <dd>其中term是一个或多个换行符或 <code>;</code> 来终止。打印一组单词，每个单词后面都有一个数字。如果省略 <code>in</code>，请使用位置参数。如果 shell 是交互式（interactive）的且处于活动状态，或者是标准输入，则将打印 <code>PROMPT3</code> 提示符，并从行编辑器中读取一行。如果此行由列出的单词之一的数字组成，则将参数 name 设置为与该数字相对应的单词。如果该行为空，则再次打印选择列表。否则，参数名称的值将设置为 <code>null</code>。从标准输入读取的行的内容保存在参数 <code>REPLY</code> 中。对每个选择执行列表，直到遇到中断或文件结束。</dd> <dt><code>(</code> list <code>)</code></dt> <dd>在子 shell (subshell)中执行列表。内置 trap 设置的 trap 在执行列表时会重置为其默认值。</dd> <dt><code>{</code> list <code>}</code></dt> <dd>执行列表</dd> <dt><code>{</code> try-list <code>}</code> <code>always</code> <code>{</code> always-list <code>}</code></dt> <dd>首先执行 try-list 。不管错误，还是 try-list 中遇到的中断或继续命令，都执行 always-list。然后，从 try-list 的执行结果继续执行；否则，将继续执行。换句话说，任何错误，中断或继续命令都将以正常方式处理，就像 alwayslist 不存在一样。这两个代码块分别称为“try block”和“always block”。 <br> 可选的换行符或分号可能会出现在 <code>always</code> 后面；但是请注意，它们可能不会出现在前面的右大括号和 <code>always</code> 之间。<br> 在这种情况下，“错误”是指诸如语法错误之类的情况，它会导致 shell 中止当前函数，脚本或列表的执行。Shell 解析代码时遇到语法错误，always-list 将不会被执行。例如，错误构造的 try-list 中的 if 块会导致 shell 在解析过程中中止，从而将不会执行 always-list ，而诸如 <code>${*foo*}</code> 之类的错误替换会导致运行时错误，之后将执行 always-list。 <br> 可以使用特殊的整数变量 <code>TRY_BLOCK_ERROR</code> 测试并重置错误条件。在 always-list 之外，该值无关紧要，但将其初始化为 -1。在 always-list 内，如果 try-list 中发生错误，则值为 1，否则为 0。如果在 always-list 期间将 <code>TRY_BLOCK_ERROR</code> 设置为 0，则将重置由 try-list 引起的错误条件，并在 always-list 之后继续执行 shell。在 try-list 期间更改值没有用（除非这构成封闭的 always block 的一部分）。 <br> 无论 <code>TRY_BLOCK_ERROR</code> 如何，always-list 末尾调用 <code>$?</code> 是从 try-list 返回的值。即使发生错误，即使 <code>TRY_BLOCK_ERROR</code> 设置为零，该值也不为零。 <br> 下面的代码执行给定的代码，而忽略其引起的任何错误。这是通过在子 shell 中执行代码来保护代码的常规约定的替代方法。 <div class=highlight><pre><span></span><code><span class=o>{</span>
    <span class=c1># 可能导致错误的代码</span>
<span class=o>}</span> always <span class=o>{</span>
    <span class=c1># 不管错误如何，都将执行此代码。</span>
    <span class=o>((</span> <span class=nv>TRY_BLOCK_ERROR</span> <span class=o>=</span> <span class=m>0</span> <span class=o>))</span>
<span class=o>}</span>
<span class=c1># 错误条件已被重置。</span>
</code></pre></div> 当 try block 出现在任何函数之外时，try-list 中遇到的返回或退出不会导致 always-list 的执行。相反，在执行任何 EXIT trap 后，shell 会立即退出。否则，在 try-list 中遇到的 return 命令将导致 always-list 的执行，就像中断和继续一样。</dd> <dt><code>function</code> word ... <code>[ () ] [ term ] {</code> list <code>}</code></dt> <dt>word ... <code>() [ term ] {</code> list <code>}</code></dt> <dt>word ... <code>() [ term ]</code> command</dt> <dd>其中term是一个或多个换行符或 <code>;</code>。定义一个单词可以引用的函数。通常，只提供一个单词；多个单词仅对设置 trap 有用。函数的主体是 <code>{</code> 和 <code>}</code> 之间的列表。请参阅 %%。 <br> 如果将选项 <code>SH_GLOB</code> 设置为与其他 shell 兼容，则当一个 word 时，左右括号之间可能会出现空格；否则，在这种情况下，括号将被视为形成 globbing pattern。 <br> 在上述任何形式中，重定向都可能出现在函数主体外部，例如： <div class=highlight><pre><span></span><code>func<span class=o>()</span> <span class=o>{</span> ... <span class=o>}</span> <span class=m>2</span>&gt;<span class=p>&amp;</span><span class=m>1</span>
</code></pre></div> 重定向与函数一起存储，并在执行函数时应用。重定向中的所有变量都会在执行函数时扩展，但会超出函数范围。</dd> <dt><code>time</code> [ pipeline ]</dt> <dd>执行管道，并以TIMEFMT参数指定的形式在标准错误报告时序统计信息。如果省略管道，则打印有关 shell 进程及其子进程的统计信息。</dd> <dt><code>[[</code> exp <code>]]</code></dt> <dd>计算条件表达式 exp，如果为 true ，则返回零。有关 exp 的描述，请参见 %%。</dd> </dl> <h2 id=_3>复杂命令的替代形式<a class=headerlink href=#_3 title="Permanent link">&para;</a></h2> <p>zsh 的许多复杂命令都有其他形式。这些是非标准的，即使是对经验丰富的 shell 程序员来说也可能不明显。在不应该考虑 shell 代码可移植性的任何地方都不应使用它们。</p> <p>仅当子列表的格式为 <code>{ list }</code> 或设置了 <code>SHORT_LOOPS</code> 选项时，以下简短版本才有效。对于 <code>if</code>、<code>while</code> 和 <code>until</code> 命令，在这两种情况下，循环的测试部分也都必须适当地定界，例如用 <code>[[... ...]]</code> 或 <code>(( ... ))</code> ，否则测试结束将不被认可。对于 <code>for</code>、<code>repeat</code>、<code>case</code> 和 <code>select</code> 命令，不需要为参数使用这种特殊形式，但是其他条件（子列表的特殊形式或使用 <code>SHORT_LOOPS</code> 选项）仍然适用。</p> <dl> <dt><code>if</code> list <code>{</code> list <code>}</code> [ <code>elif</code> list <code>{</code> list <code>}</code> ] ... [ <code>else</code> <code>{</code> list <code>}</code> ]</dt> <dd>if的替代形式。上述规则意味着 <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=o>[[</span> -o ignorebraces <span class=o>]]</span> <span class=o>{</span>
  print yes
<span class=o>}</span>
</code></pre></div> 可以工作，但 <div class=highlight><pre><span></span><code><span class=k>if</span> <span class=nb>true</span> <span class=o>{</span>  <span class=c1># 不起作用！</span>
  print yes
<span class=o>}</span>
</code></pre></div> <em>并不会</em> ，因为测试没有适当划分界限。</dd> <dt><code>if</code> list sublist</dt> <dd>替代 <code>if</code> 的简短形式。列表形式的限制与前一形式相同。</dd> <dt><code>for</code> name ... <code>(</code> word ... <code>)</code>sublist</dt> <dd><code>for</code> 的简短形式。</dd> <dt><code>for</code> name ... [ <code>in</code> word ... ] term sublist</dt> <dd>其中 term 是至少一个换行符或 <code>;</code>。 <code>for</code> 的另一种简短形式。</dd> <dt><code>for</code> <code>(( [expr1] ; [expr2] ; [expr3] ))</code> sublist</dt> <dd>命令算术的缩写。</dd> <dt><code>foreach</code> name ... <code>(</code> word ... <code>)</code> list <code>end</code></dt> <dd><code>for</code> 的另一种形式。</dd> <dt><code>while</code> list <code>{</code> list <code>}</code></dt> <dd><code>while</code> 的另一种形式。注意上面提到的列表形式的限制。</dd> <dt><code>until</code> list <code>{</code> list <code>}</code></dt> <dd><code>until</code> 的另一种形式。注意上面提到的列表形式的限制。</dd> <dt><code>repeat</code> word sublist</dt> <dd>这是重复的简短形式。</dd> <dt><code>case</code> word <code>{ [ [(]</code> pattern <code>[ |</code> pattern <code>]</code> ... <code>)</code> list <code>(;;|;&amp;|;|) ]</code> ... <code>}</code></dt> <dd><code>case</code> 的另一种形式。</dd> <dt><code>select</code> name [ <code>in</code> word ... term ] sublist</dt> <dd>其中 term 是至少一个换行符或 <code>;</code>。<code>select</code> 的简短形式。</dd> <dt><code>function</code> word ... [ <code>()</code> ] [ term ] sublist</dt> <dd>这是函数的简短形式。</dd> </dl> <h2 id=_4>保留字<a class=headerlink href=#_4 title="Permanent link">&para;</a></h2> <p>下列单词用作命令的第一个单词时，将被视为保留单词，除非引用起来或者使用 <code>disable -r</code> 对其进行了禁用：</p> <p><code>do</code> <code>done</code> <code>esac</code> <code>then</code> <code>elif</code> <code>else</code> <code>fi</code> <code>for</code> <code>case</code> <code>if</code> <code>while</code> <code>function</code> <code>repeat</code> <code>time</code> <code>until</code> <code>select</code> <code>coproc</code> <code>nocorrect</code> <code>foreach</code> <code>end</code> <code>!</code> <code>[[</code> <code>{</code> <code>}</code> <code>declare</code> <code>export</code> <code>float</code> <code>integer</code> <code>local</code> <code>readonly</code> <code>typeset</code></p> <p>此外，如果未设置 <code>IGNORE_BRACES</code> 选项或 <code>IGNORE_CLOSE_BRACES</code> 选项，则在任何位置都可以识别 <code>}</code>。</p> <hr> <div class=md-source-date> <small> 最后更新: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2021-10-03 09:29:29</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../05-files/ class="md-footer__link md-footer__link--prev" aria-label="上一页: 第五章：文件" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 上一页 </span> 第五章：文件 </div> </div> </a> <a href=../07-redirection/ class="md-footer__link md-footer__link--next" aria-label="下一页: 第七章：重定向" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> 下一页 </span> 第七章：重定向 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> 2020-2021 夜坂雅及<a href=https://github.com/ShadowRZ/zshdocs-zh/graphs/contributors>其他贡献者</a> </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script> <script src=../assets/javascripts/bundle.c7d1b464.min.js></script> </body> </html>